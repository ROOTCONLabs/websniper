# dnsMiscon.py
# description: checks if the domain has a dns misconfiguration
# author: @shipcod3
# reference: http://www.securityfocus.com/archive/1/486606 

import sys, socket, time

from datetime import datetime

class dnsmisconfig:
    
    def __init__(self, core):
        pass

    def run(self):
        # runtime recorder
        starttime = datetime.now()
        
        print 'Set RHOST:',
        rhost = raw_input()
        print ""
        print "[****] Starting DNS Misconfiguration check"
        time.sleep(2)
        print ""
        print "[+]Resolving the host address localhost."+rhost+"" # Resolve the target host
        time.sleep(2)
        try:
            ip_addr = socket.gethostbyaddr("localhost."+rhost)
            if ip_addr[0] == "localhost":
                print '>> Vulnerable to DNS Misconfiguration which leads to Same-Site Scripting'
            else:
                print '>> Not Vulnerable'
        except socket.error:
            print '>> Unable to resolve host (not vulnerable)*'
        time.sleep(2)
        print ""  
        print "[####] Done!!!"
        print ""
        time.sleep(3)
        endtime = datetime.now()
        total = endtime - starttime
        print 'Runtime: ', total
