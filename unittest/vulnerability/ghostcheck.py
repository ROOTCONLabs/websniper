# ghostcheck.py
# description: Wordpress is vulnerable to Ghost Vulnerability, this module will check if RPC is enabled.
# author: @semprix

import urllib2, sys, time, datetime, xmlrpclib

print "Set URL (http://www.yourdomain.com/<location-of-xmlrpc.php-file)"
targeturl = raw_input()
print "[*] Starting ghostcheck..."
request = urllib2.Request(targeturl)
request.get_method = lambda : 'HEAD'
try:
	print "[+] Trying if URL exist"
	time.sleep(2)
    	response = urllib2.urlopen(request)
    	print ">> Got 200 response, this could be a custom error page, check manually"
    	print "[+] Trying to send data"
    	time.sleep(2)
    	wp_url = targeturl
	server = xmlrpclib.ServerProxy(wp_url)
  	try:
   	 server.demo.addTwoNumbers(1, 1)
   	 print "** VULNERABLE (XML-RPC Interface is available)"
  	except xmlrpclib.ProtocolError as err:
    	  print "[!] A protocol error occurred"
    	  print "[!] Error code: %d" % err.errcode
except urllib2.HTTPError:
    print "[!] Got an HTTP Error response"

print "[!] Done...."